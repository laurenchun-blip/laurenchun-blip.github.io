<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hybrid Design: Binary + Manual Control</title>
    <style>
      :root {
        --primary-blue: #2563eb;
        --border: #e5e7eb;
        --text-main: #1f2937;
        --text-muted: #6b7280;
        --success-bg: #ecfdf5;
        --fail-bg: #fff7ed;
      }
      body {
        font-family: sans-serif;
        background: #f3f4f6;
        padding: 20px;
        display: flex;
        justify-content: center;
      }
      .card {
        background: white;
        width: 500px;
        padding: 24px;
        border-radius: 12px;
        border: 1px solid var(--border);
        box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
      }

      .search-input {
        width: 100%;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: 15px;
        box-sizing: border-box;
        margin-bottom: 12px;
      }

      /* Notification Area */
      .status-area {
        min-height: 80px;
        margin-bottom: 16px;
        border-radius: 8px;
        padding: 12px;
        border: 1px solid transparent;
        display: none;
      }
      .status-area.visible {
        display: block;
      }
      .status-area.success {
        background: var(--success-bg);
        border-color: #10b981;
      }
      .status-area.fail {
        background: var(--fail-bg);
        border-color: #f97316;
      }

      .suggestion-chips {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        margin-top: 8px;
      }
      .chip {
        background: white;
        border: 1px solid var(--border);
        padding: 4px 10px;
        border-radius: 14px;
        font-size: 12px;
        cursor: pointer;
      }
      .chip:hover {
        border-color: var(--primary-blue);
      }

      /* Map and Controls */
      .map-container {
        height: 300px;
        background: #e5e7eb;
        border-radius: 8px;
        position: relative;
        overflow: hidden;
        cursor: crosshair;
        margin-bottom: 16px;
      }
      .radius-circle {
        background: rgba(37, 99, 235, 0.15);
        border: 2px solid var(--primary-blue);
        border-radius: 50%;
        position: absolute;
        pointer-events: none;
        transform: translate(-50%, -50%);
        transition:
          width 0.2s,
          height 0.2s;
      }
      .pin {
        position: absolute;
        font-size: 28px;
        cursor: grab;
        transform: translate(-50%, -100%);
        z-index: 10;
        user-select: none;
      }
      .pin:active {
        cursor: grabbing;
      }

      .slider-box {
        background: #f9fafb;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid var(--border);
        margin-bottom: 12px;
      }
      .slider-header {
        display: flex;
        justify-content: space-between;
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 8px;
      }
      input[type="range"] {
        width: 100%;
        accent-color: var(--primary-blue);
        cursor: pointer;
      }

      .btn-next {
        width: 100%;
        background: #111827;
        color: white;
        border: none;
        padding: 14px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 16px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h3 style="margin: 0 0 16px 0">Find Your Ad Space</h3>

      <input type="text" id="search" class="search-input" value="Oakland, CA" />

      <div id="status" class="status-area"></div>
      <div class="slider-box">
        <div class="slider-header">
          <span>Search Radius</span>
          <span id="miles-val" style="color: var(--primary-blue)">5 miles</span>
        </div>
        <input type="range" id="radius-slider" min="1" max="50" value="5" />
      </div>
      <div class="map-container" id="map">
        <div id="visual-radius" class="radius-circle"></div>
        <div id="draggable-pin" class="pin">üìç</div>
        <div
          style="
            width: 500px;
            height: 300px;
            overflow: hidden;
            border: 1px solid #ccc;
          "
        >
          <img
            src="assets/map.jpg"
            style="width: 100%; height: 100%; object-fit: cover"
          />
        </div>
      </div>

      <button class="btn-next">Next Step</button>
    </div>

    <script>
      const searchInput = document.getElementById("search");
      const statusArea = document.getElementById("status");
      const map = document.getElementById("map");
      const pin = document.getElementById("draggable-pin");
      const radiusCircle = document.getElementById("visual-radius");
      const slider = document.getElementById("radius-slider");
      const milesVal = document.getElementById("miles-val");

      // Mock Settings
      let currentX = 300;
      let currentY = 165;
      let isDragging = false;
      const pockets = [
        { name: "Downtown SF", x: 150, y: 180, signs: 2 },
        { name: "Orinda", x: 390, y: 80, signs: 2 },
        { name: "Berkeley Hub", x: 290, y: 80, signs: 3 },
      ];

      function updateEverything() {
        // Update Pin Position
        pin.style.left = currentX + "px";
        pin.style.top = currentY + "px";
        radiusCircle.style.left = currentX + "px";
        radiusCircle.style.top = currentY + "px";

        // Update Radius Size
        const miles = slider.value;
        const pxRadius = miles * 6;
        radiusCircle.style.width = pxRadius * 2 + "px";
        radiusCircle.style.height = pxRadius * 2 + "px";
        milesVal.innerText = `${miles} miles`;

        // Calculate Signs
        let totalSigns = 0;
        pockets.forEach((p) => {
          const dist = Math.sqrt(
            Math.pow(p.x - currentX, 2) + Math.pow(p.y - currentY, 2),
          );
          if (dist < pxRadius) totalSigns += p.signs;
        });

        // Update Status Box
        statusArea.className =
          "status-area visible " + (totalSigns > 0 ? "success" : "fail");
        if (totalSigns > 0) {
          statusArea.innerHTML = `<strong>‚úì Market Active</strong><br>${totalSigns} signs found in this zone.`;
        } else {
          statusArea.innerHTML = `
        <strong>No signs found here.</strong><br>
        Try expanding your radius or use suggested locations below.
        <div class="suggestion-chips">
          <div class="chip" onclick="moveTo(150, 180, 'San Francisco')">San Francisco - 3 signs </div>
          <div class="chip" onclick="moveTo(290, 80, 'Berkeley Hub')">Berkeley - 2 signs </div>
          <div class="chip" onclick="moveTo(390, 80, 'Orinda')">Orinda - 2 signs</div>

        </div>
      `;
        }
      }

      // Interaction Logic
      window.moveTo = (x, y, name) => {
        currentX = x;
        currentY = y;
        searchInput.value = name;
        updateEverything();
      };

      pin.addEventListener("mousedown", (e) => {
        isDragging = true;
        e.preventDefault();
      });
      window.addEventListener("mouseup", () => (isDragging = false));
      window.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        const rect = map.getBoundingClientRect();
        currentX = Math.max(0, Math.min(e.clientX - rect.left, 500));
        currentY = Math.max(0, Math.min(e.clientY - rect.top, 300));
        updateEverything();
      });

      slider.addEventListener("input", updateEverything);
      updateEverything();
    </script>
  </body>
</html>
